<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Selamat Wisuda, Ataa üå∏</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Playfair+Display:wght@400;700&family=Great+Vibes&display=swap" rel="stylesheet">

  <style>
    :root{
      --pink:#ffbfd6;
      --soft-pink:#fff0f6;
      --purple:#8e6fb7;
      --light-blue:#bfe9ff;
      --muted:#6a4b7f;
      --card-bg:rgba(255,255,255,0.94);
      --glass: rgba(255,255,255,0.28);
      --radius:20px;
      --max-width:1100px;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Poppins,system-ui,Arial;color:#3b2a49;background: linear-gradient(180deg,var(--soft-pink), #f6f2ff 45%, #eef9ff 100%);}    

    /* watercolor backdrop */
    .watercolor{position:fixed; inset:0; pointer-events:none; z-index:0; opacity:0.95}
    .container{min-height:100vh;display:flex;align-items:center;justify-content:center;position:relative;padding:28px;z-index:2}

    /* main card */
    .card{width:100%;max-width:var(--max-width);background:var(--card-bg);border-radius:28px;box-shadow:0 18px 40px rgba(85,40,110,0.12);padding:34px;backdrop-filter: blur(8px);}

    header{display:flex;gap:18px;align-items:center;}
    .logo{display:flex;align-items:center;gap:14px}
    .logo .badge{width:68px;height:68px;border-radius:16px;background:linear-gradient(135deg,var(--purple),var(--pink));display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-family:'Great Vibes',cursive;font-size:28px;box-shadow:0 8px 18px rgba(150,80,170,0.12)}
    h1{margin:0;font-size:20px;color:#4b2f67;font-weight:700}
    .tag{color:var(--muted);font-size:13px}

    .layout{display:grid;grid-template-columns:420px 1fr;gap:28px;margin-top:18px}

    /* Landing left column */
    .panel{padding:18px;border-radius:18px;background:linear-gradient(180deg,rgba(255,255,255,0.6),rgba(255,255,255,0.82));box-shadow:inset 0 1px 0 rgba(255,255,255,0.6)}
    .landing{display:flex;flex-direction:column;gap:14px}
    .hero-illustration{height:140px;display:flex;align-items:center;justify-content:center}
    .hero-illustration svg{width:100%;height:100%}
    .input-row{display:flex;gap:12px;align-items:center}
    input[type=text]{flex:1;padding:14px 16px;border-radius:12px;border:1px solid rgba(120,100,150,0.08);font-size:16px;box-shadow:0 6px 18px rgba(120,80,140,0.03)}

    .btn{background:linear-gradient(90deg,var(--purple),var(--pink));color:white;padding:12px 18px;border-radius:12px;border:0;font-weight:700;cursor:pointer;box-shadow:0 8px 18px rgba(140,80,170,0.12);transition:transform .16s ease}
    .btn:hover{transform:translateY(-3px)}

    .muted{color:var(--muted);font-size:14px}

    /* Right column (main area) */
    .home{display:flex;flex-direction:column;gap:18px;padding:8px}
    .greeting{display:flex;gap:12px;flex-direction:column;align-items:center;text-align:center;padding:12px}
    .greeting h2{font-family:'Playfair Display',serif;font-size:48px;margin:0;color:var(--purple);line-height:1}
    .poem{max-width:740px;color:#4a2f5a;font-size:18px;line-height:1.7;padding:6px}

    /* Controls */
    .controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap;justify-content:center;margin-top:6px}
    .audio-controls{display:flex;gap:10px;align-items:center;background:var(--glass);padding:8px;border-radius:12px}

    /* Upload area */
    .uploader{display:flex;gap:12px;align-items:center;flex-wrap:wrap;justify-content:center;margin-top:6px}
    .thumb{width:160px;height:160px;border-radius:14px;overflow:hidden;background:linear-gradient(180deg,var(--light-blue),var(--soft-pink));display:flex;align-items:center;justify-content:center;border:1px dashed rgba(120,80,140,0.08)}
    .thumb img{width:100%;height:100%;object-fit:cover}

    .card-preview{margin-top:6px;display:flex;gap:18px;flex-direction:column;align-items:center}
    .download-btn{background:linear-gradient(90deg,#ff8fc0,#9b7adf);border:0;padding:12px 18px;border-radius:12px;color:white;font-weight:700;cursor:pointer}

    footer{margin-top:8px;text-align:center;color:var(--muted);font-size:13px}

    /* Responsive */
    @media (max-width:980px){
      .layout{grid-template-columns:1fr;}
      .logo .badge{width:56px;height:56px;font-size:24px}
      .greeting h2{font-size:36px}
      .card{padding:20px}
    }

    @media (max-width:520px){
      .greeting h2{font-size:30px}
      .thumb{width:120px;height:120px}
      input[type=text]{font-size:15px}
    }

    /* confetti */
    #confetti{position:fixed;inset:0;pointer-events:none;z-index:1}

    /* subtle focus states */
    input:focus, button:focus{outline:3px solid rgba(155,122,223,0.12);outline-offset:3px}

    /* file input nicer */
    input[type=file]{font-size:14px}

  </style>
</head>
<body>

  <!-- decorative watercolor -->
  <svg class="watercolor" viewBox="0 0 1200 800" preserveAspectRatio="xMidYMid slice" aria-hidden="true">
    <g opacity="0.38">
      <ellipse cx="120" cy="160" rx="240" ry="130" fill="#f9e6ff"/>
      <ellipse cx="1040" cy="700" rx="420" ry="240" fill="#e8f8ff"/>
      <ellipse cx="920" cy="110" rx="260" ry="160" fill="#fff0f6"/>
    </g>
    <g opacity="0.28">
      <circle cx="160" cy="220" r="120" fill="#eed4ff"/>
      <circle cx="360" cy="80" r="90" fill="#ffd9ec"/>
      <circle cx="860" cy="420" r="160" fill="#dfe9ff"/>
    </g>
  </svg>

  <canvas id="confetti" aria-hidden="true"></canvas>

  <div class="container">
    <div class="card" role="main">
      <header>
        <div class="logo">
          <div class="badge" aria-hidden="true">A</div>
          <div>
            <h1>Selamat Wisuda, Ataa</h1>
            <div class="tag">Halaman ucapan personal ‚Äî dreamy, feminine, & elegant</div>
          </div>
        </div>
      </header>

      <div class="layout">

        <!-- Left: Landing & controls -->
        <aside class="panel">
          <div class="landing">
            <div class="hero-illustration" aria-hidden="true">
              <!-- gentle floral svg as illustration -->
              <svg viewBox="0 0 300 140" xmlns="http://www.w3.org/2000/svg">
                <g fill="none" fill-rule="evenodd">
                  <ellipse cx="60" cy="80" rx="52" ry="28" fill="#f7e6ff"/>
                  <ellipse cx="240" cy="40" rx="70" ry="34" fill="#eef8ff"/>
                  <g transform="translate(30,10)">
                    <path d="M40 30c10-14 34-18 54-8" stroke="#9b7adf" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="46" cy="24" r="6" fill="#ffbfd6"/>
                    <circle cx="84" cy="18" r="5" fill="#bfe9ff"/>
                  </g>
                </g>
              </svg>
            </div>

            <div>
              <p style="margin:0 0 6px 0;font-weight:600;color:#4b2f67">Buat halaman ucapan personal untuk Ataa</p>
              <p class="muted" style="margin:0 0 10px 0">Masukkan nama (atau biarkan default: Ataa) lalu tekan <strong>Masuk</strong>.</p>
            </div>

            <div class="input-row">
              <input id="nameInput" type="text" aria-label="Masukkan nama" placeholder="Tulis nama... (contoh: Ataa)" value="Ataa" />
              <button class="btn" id="enterBtn" aria-label="Masuk">Masuk</button>
            </div>

            <div style="display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:8px">
              <div class="muted">Warna tema: Ungu ‚Ä¢ Pink ‚Ä¢ Biru muda</div>
              <div class="muted">Responsif ‚Ä¢ Siap HP</div>
            </div>

            <div style="margin-top:12px;font-size:13px;color:var(--muted)">Tip: Tekan <kbd>Enter</kbd> di kolom nama untuk langsung masuk.</div>

          </div>
        </aside>

        <!-- Right: Home / preview area -->
        <section class="home" id="home" aria-live="polite">
          <div class="greeting">
            <h2 id="heroName">Untuk: Ataa</h2>
            <div class="poem" id="poem" aria-atomic="true"></div>

            <div class="controls">
              <div class="audio-controls" title="Kontrol musik">
                <button id="playAudio" class="btn" style="padding:8px 12px;">Play</button>
                <label style="font-size:13px;color:#5b3b7a;margin-left:8px">Pilih lagu (opsional)</label>
                <input id="audioFile" type="file" accept="audio/*" aria-label="Unggah lagu" />
              </div>

              <div>
                <button id="backBtn" class="btn" style="background:transparent;border:1px solid rgba(120,80,140,0.08);color:var(--purple);">Kembali</button>
              </div>
            </div>

            <div class="uploader">
              <div style="display:flex;flex-direction:column;gap:6px;align-items:center">
                <label class="muted">Unggah foto untuk kartu ucapan</label>
                <input id="photoFile" type="file" accept="image/*" aria-label="Unggah foto" />
              </div>

              <div class="thumb" id="thumb">Preview</div>
            </div>

            <div class="card-preview">
              <canvas id="cardCanvas" width="1200" height="700" style="max-width:100%;border-radius:14px;box-shadow:0 12px 30px rgba(100,60,120,0.08);"></canvas>
              <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:center">
                <button id="downloadJpg" class="download-btn">Download sebagai JPG</button>
                <button id="resetPic" class="btn" style="background:transparent;border:1px solid rgba(120,80,140,0.08);color:var(--purple);">Reset Foto</button>
              </div>
            </div>

          </div>

          <footer>
            <small>Made with love ‚ú® ‚Äî Tekan Play untuk musik, unggah foto untuk kartu, lalu download.</small>
          </footer>
        </section>

      </div>
    </div>
  </div>

  <!-- Hidden audio element -->
  <audio id="bgAudio" loop></audio>

  <script>
    // ---------- Elements ----------
    const landing = document.getElementById('nameInput').closest('.card').querySelector('.landing');
    const home = document.getElementById('home');
    const nameInput = document.getElementById('nameInput');
    const enterBtn = document.getElementById('enterBtn');
    const heroName = document.getElementById('heroName');
    const poemEl = document.getElementById('poem');
    const bgAudio = document.getElementById('bgAudio');
    const playAudio = document.getElementById('playAudio');
    const audioFile = document.getElementById('audioFile');

    // poem template
    const poemTemplate = name => `

Selamat wisuda, ${name} üíê

Hari ini bukan sekadar akhir perjalanan,
tapi awal dari mimpi-mimpi yang mulai terbang lebih tinggi.

Langit tersenyum melihat langkahmu,
dan setiap bunga bermekaran memanggil namamu dengan bangga.

Semoga setiap langkahmu selalu dihiasi keberanian,
cinta, dan kebahagiaan yang tak berujung.

Dunia menunggu sinar terbaik darimu,
dan hari ini ‚Äî semuanya dimulai dari senyum cantikmu. üí´
`;

    function showHome(name){
      // hide landing aside by collapsing layout (better mobile behavior)
      const layout = document.querySelector('.layout');
      if(window.innerWidth < 980){
        layout.style.gridTemplateColumns = '1fr';
      }
      heroName.textContent = `Untuk: ${name}`;
      typePoem(poemTemplate(name));
      startConfetti();
      // focus for accessibility
      setTimeout(()=> poemEl.scrollIntoView({behavior:'smooth',block:'center'}),300);
    }

    enterBtn.addEventListener('click', ()=>{
      const name = nameInput.value.trim() || 'Ataa';
      showHome(name);
    });

    // allow Enter key
    nameInput.addEventListener('keydown',(e)=>{ if(e.key === 'Enter'){ enterBtn.click(); } });

    document.getElementById('backBtn').addEventListener('click', ()=>{
      // restore layout
      const layout = document.querySelector('.layout');
      layout.style.gridTemplateColumns = window.innerWidth < 980 ? '1fr' : '420px 1fr';
      stopConfetti();
      // clear poem
      poemEl.textContent = '';
    });

    // typing effect with small pauses for punctuation
    function typePoem(text){
      poemEl.textContent='';
      let i=0; const speedBase = 16;
      function step(){
        if(i<text.length){
          poemEl.textContent += text.charAt(i);
          i++;
          let delay = speedBase;
          const ch = text.charAt(i-1);
          if([',','‚Äì','‚Äî','.','
'].includes(ch)) delay = speedBase * 6; // slightly longer for punctuation/newline
          setTimeout(step,delay);
        }
      }
      step();
    }

    // ---------- Audio handling ----------
    let audioLoaded=false;
    audioFile.addEventListener('change', (e)=>{
      const f = e.target.files[0];
      if(!f) return;
      const url = URL.createObjectURL(f);
      bgAudio.src = url;
      audioLoaded=true;
      bgAudio.play().catch(()=>{});
      playAudio.textContent='Pause';
    });

    playAudio.addEventListener('click', async ()=>{
      if(bgAudio.paused){
        try{ await bgAudio.play(); playAudio.textContent='Pause'; }catch(e){ console.log('autoplay blocked'); }
      }else{ bgAudio.pause(); playAudio.textContent='Play'; }
    });

    // ---------- Photo upload & card canvas ----------
    const photoFile = document.getElementById('photoFile');
    const thumb = document.getElementById('thumb');
    const cardCanvas = document.getElementById('cardCanvas');
    const ctx = cardCanvas.getContext('2d');
    let uploadedImage = null;

    function drawCard(name){
      const w = cardCanvas.width; const h = cardCanvas.height;
      ctx.clearRect(0,0,w,h);
      // soft gradient background
      const grad = ctx.createLinearGradient(0,0,w,h);
      grad.addColorStop(0,'#fff8ff');
      grad.addColorStop(0.55,'#f7f2ff');
      grad.addColorStop(1,'#eef9ff');
      ctx.fillStyle = grad;
      roundRect(ctx,0,0,w,h,28); ctx.fill();

      // accent shapes
      ctx.fillStyle = 'rgba(155,122,223,0.12)'; ctx.beginPath(); ctx.ellipse(w-180,120,240,90,0,0,Math.PI*2); ctx.fill();
      ctx.fillStyle = 'rgba(255,200,230,0.12)'; ctx.beginPath(); ctx.ellipse(120,h-130,220,90,0,0,Math.PI*2); ctx.fill();

      // image area
      const hasImg = !!uploadedImage;
      if(hasImg){
        const imgW = Math.min(520, w*0.44);
        const imgH = imgW * (uploadedImage.height/uploadedImage.width);
        const imgX = 80; const imgY = (h - imgH)/2;
        roundClip(ctx,imgX,imgY,imgW,imgH,18);
        ctx.drawImage(uploadedImage, imgX, imgY, imgW, imgH);
        ctx.restore();
      }

      // title
      ctx.fillStyle = 'rgba(70,30,110,0.95)';
      ctx.font = '44px "Playfair Display", serif';
      ctx.fillText(`Untuk: ${name}`, hasImg? 640:120, 160);

      // poem text
      ctx.font = '20px Poppins, sans-serif';
      wrapText(ctx, getShortPoem(name), hasImg?640:120, 220, 460, 32);

      // footer
      ctx.fillStyle = 'rgba(90,50,120,0.6)'; ctx.font = '16px Poppins, sans-serif';
      ctx.fillText('Selamat Wisuda ‚Ä¢ Dibuat dengan cinta', w-420, h-36);
    }

    function getShortPoem(name){
      return `Hari ini bukan akhir, tapi awal dari mimpi yang mulai terbang.
Langit tersenyum melihat langkahmu, ${name}.
Semoga langkahmu selalu dihiasi keberanian dan cinta.`;
    }

    // initial
    drawCard('Ataa');

    photoFile.addEventListener('change', (e)=>{
      const f = e.target.files[0]; if(!f) return;
      const reader = new FileReader();
      reader.onload = function(ev){
        const img = new Image(); img.onload = ()=>{ uploadedImage = img; thumb.innerHTML = ''; const timg = document.createElement('img'); timg.src = ev.target.result; thumb.appendChild(timg); drawCard(nameInput.value.trim() || 'Ataa'); };
        img.src = ev.target.result;
      };
      reader.readAsDataURL(f);
    });

    document.getElementById('resetPic').addEventListener('click', ()=>{ uploadedImage = null; thumb.innerHTML = 'Preview'; drawCard(nameInput.value.trim() || 'Ataa'); });

    document.getElementById('downloadJpg').addEventListener('click', ()=>{
      const tmpCanvas = document.createElement('canvas'); tmpCanvas.width = 1800; tmpCanvas.height = 1050; const tctx = tmpCanvas.getContext('2d'); const sx = tmpCanvas.width / cardCanvas.width; tctx.scale(sx,sx); tctx.drawImage(cardCanvas,0,0); const link = document.createElement('a'); link.href = tmpCanvas.toDataURL('image/jpeg',0.92); link.download = `${(nameInput.value.trim()||'Ataa')}_wisuda_card.jpg`; link.click();
    });

    // helpers
    function roundRect(ctx,x,y,w,h,r){ ctx.beginPath(); ctx.moveTo(x+r,y); ctx.arcTo(x+w,y,x+w,y+h,r); ctx.arcTo(x+w,y+h,x,y+h,r); ctx.arcTo(x,y+h,x,y,r); ctx.arcTo(x,y,x+w,y,r); ctx.closePath(); }
    function roundClip(ctx,x,y,w,h,r){ ctx.save(); ctx.beginPath(); roundRect(ctx,x,y,w,h,r); ctx.clip(); }
    function wrapText(ctx, text, x, y, maxWidth, lineHeight){ const words = text.split(' '); let line=''; for(let n=0;n<words.length;n++){ const testLine = line + words[n] + ' '; const metrics = ctx.measureText(testLine); const testWidth = metrics.width; if(testWidth>maxWidth && n>0){ ctx.fillText(line, x, y); line = words[n] + ' '; y += lineHeight; }else{ line = testLine; } } ctx.fillText(line, x, y); }

    // ---------- Confetti ----------
    const confettiCanvas = document.getElementById('confetti'); const confettiCtx = confettiCanvas.getContext('2d'); let confettiParticles = []; let confettiRunning = false;
    function resizeConfetti(){ confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight; }
    addEventListener('resize', resizeConfetti); resizeConfetti();
    function rand(min,max){return Math.random()*(max-min)+min}
    function spawnParticle(){ const w = rand(8,20); const h = rand(12,32); confettiParticles.push({ x: rand(0,confettiCanvas.width), y: -30, vx: rand(-0.6,0.6), vy: rand(1.2,2.8), r: rand(0,Math.PI*2), vr: rand(-0.05,0.05), w, h, color: ['#9b7adf','#ff8fc0','#bfe9ff','#f9d7ff'][Math.floor(rand(0,4))], time:0 }); }
    function drawParticles(){ confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height); for(let i=confettiParticles.length-1;i>=0;i--){ const p = confettiParticles[i]; p.time += 1; p.x += p.vx; p.y += p.vy; p.r += p.vr; confettiCtx.save(); confettiCtx.translate(p.x,p.y); confettiCtx.rotate(p.r); confettiCtx.fillStyle = p.color; confettiCtx.fillRect(-p.w/2,-p.h/2,p.w,p.h); confettiCtx.restore(); if(p.y > confettiCanvas.height + 80) confettiParticles.splice(i,1); } }
    let confettiTicker = null; function startConfetti(){ if(confettiRunning) return; confettiRunning = true; confettiTicker = setInterval(()=>{ if(Math.random()<0.55) spawnParticle(); drawParticles(); }, 28); } function stopConfetti(){ confettiRunning=false; clearInterval(confettiTicker); confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height); confettiParticles=[]; }

    // initial note
    // Page requires user interaction to play audio; encourage pressing Play.

  </script>
</body>
</html>
