<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Selamat Wisuda, Ataa ðŸŒ¸</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Great+Vibes&display=swap" rel="stylesheet">

  <style>
    :root {
      --pink: #ffbfd6;
      --soft-pink: #ffdced;
      --purple: #8e6fb7;
      --light-blue: #bfe9ff;
      --dark-purple: #5a2d6b;
      --text-color: #4a2f5a;
      --card-bg: rgba(255, 255, 255, 0.96);
      --glass: rgba(255, 255, 255, 0.4);
      --radius-lg: 24px;
      --radius-md: 16px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(180deg, var(--soft-pink), #f7f0ff 40%, #eef9ff 100%);
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    .container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .card {
      width: 100%;
      max-width: 500px;
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      box-shadow: 0 8px 32px rgba(120, 90, 150, 0.15);
      padding: 24px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.6);
      overflow: hidden;
      position: relative;
    }

    header {
      display: flex;
      gap: 16px;
      align-items: center;
      margin-bottom: 24px;
    }

    .logo .badge {
      width: 52px;
      height: 52px;
      border-radius: var(--radius-md);
      background: linear-gradient(135deg, var(--purple), var(--pink));
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-family: 'Great Vibes', cursive;
      font-size: 26px;
      flex-shrink: 0;
    }

    h1 {
      font-size: 18px;
      color: var(--dark-purple);
      font-weight: 600;
      line-height: 1.4;
    }

    .muted {
      color: #6a4b7f;
      font-size: 13px;
    }

    .view.hidden {
      display: none !important;
    }

    .landing, .home {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    input[type=text] {
      width: 100%;
      padding: 14px 16px;
      border-radius: 12px;
      border: 1px solid rgba(142, 111, 183, 0.2);
      font-size: 16px;
      background: rgba(245, 240, 255, 0.6);
      color: var(--dark-purple);
    }

    input[type=text]:focus {
      outline: none;
      border-color: var(--purple);
      box-shadow: 0 0 0 4px rgba(142, 111, 183, 0.1);
    }

    .btn {
      background: linear-gradient(90deg, var(--purple), var(--pink));
      color: white;
      padding: 14px 20px;
      border-radius: 12px;
      border: 0;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(142, 111, 183, 0.2);
      text-align: center;
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(142, 111, 183, 0.3);
    }

    .btn.secondary {
      background: transparent;
      border: 1px solid rgba(120, 80, 140, 0.2);
      color: var(--purple);
      box-shadow: none;
    }

    .btn.secondary:hover {
      background: rgba(142, 111, 183, 0.08);
    }

    .greeting h2 {
      font-family: 'Great Vibes', cursive;
      font-size: 42px;
      color: var(--purple);
    }

    .poem {
      color: var(--text-color);
      font-size: 16px;
      line-height: 1.7;
    }

    canvas {
      max-width: 100%;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(100, 60, 120, 0.1);
    }

    footer {
      text-align: center;
      font-size: 12px;
      color: #6a4b7f;
      margin-top: 24px;
    }

    @media (min-width: 768px) {
      .card {
        max-width: 700px;
        padding: 36px;
      }

      .greeting h2 {
        font-size: 60px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <header>
        <div class="logo"><div class="badge">A</div></div>
        <div>
          <h1>Hari ini bunga-bunga tersenyum untukmu, Ataa ðŸŒ·</h1>
          <div class="muted">Setiap langkahmu adalah puisi, dan wisuda ini â€” bait terindah dalam kisahmu.</div>
        </div>
      </header>

      <main class="view landing" id="landing">
        <p style="color:#5c3b77">Masukkan namamu dan klik "Lanjutkan"</p>
        <input id="nameInput" type="text" placeholder="Tulis nama..." value="Ataa" />
        <button class="btn" id="enterBtn">Lanjutkan</button>
      </main>

      <section class="view home hidden" id="home">
        <div class="greeting">
          <h2 id="heroName">Untuk: Ataa</h2>
          <div class="poem" id="poem"></div>
        </div>

        <canvas id="cardCanvas" width="1200" height="700"></canvas>

        <button class="btn" id="downloadJpg">Unduh Kartu (JPG)</button>
        <button class="btn secondary" id="backBtn">Kembali</button>

        <footer>Abil, Yogyakarta, 16 Oct 2025</footer>
      </section>
    </div>
  </div>

  <script>
    const landing = document.getElementById("landing");
    const home = document.getElementById("home");
    const nameInput = document.getElementById("nameInput");
    const enterBtn = document.getElementById("enterBtn");
    const heroName = document.getElementById("heroName");
    const poemEl = document.getElementById("poem");
    const cardCanvas = document.getElementById("cardCanvas");
    const ctx = cardCanvas.getContext("2d");

    function getShortPoem(name) {
      return `Hari ini bukan akhir, tapi awal dari mimpi yang mulai terbang. Langit tersenyum melihat langkahmu, ${name}. Semoga langkahmu selalu dihiasi keberanian dan cinta.`;
    }

    function switchView(show, hide) {
      hide.classList.add("hidden");
      show.classList.remove("hidden");
    }

    enterBtn.addEventListener("click", () => {
      const name = nameInput.value.trim() || "Ataa";
      heroName.textContent = `Untuk: ${name}`;
      poemEl.textContent = getShortPoem(name);
      drawCard(name);
      switchView(home, landing);
    });

    document.getElementById("backBtn").addEventListener("click", () => {
      switchView(landing, home);
    });

    function drawCard(name) {
      const w = cardCanvas.width, h = cardCanvas.height;
      ctx.clearRect(0, 0, w, h);
      const grad = ctx.createLinearGradient(0, 0, w, h);
      grad.addColorStop(0, "#fff9ff");
      grad.addColorStop(1, "#f4faff");
      ctx.fillStyle = grad;
      ctx.fillRect(0, 0, w, h);

      ctx.fillStyle = "#5a2d6b";
      ctx.font = '64px "Great Vibes", cursive';
      ctx.textAlign = "center";
      ctx.fillText(`Untuk ${name},`, w / 2, h * 0.4);

      ctx.fillStyle = "#4a2f5a";
      ctx.font = "24px Poppins";
      wrapText(ctx, getShortPoem(name), w / 2, h * 0.5, 600, 36);
    }

    function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
      const words = text.split(" ");
      let line = "";
      for (let n = 0; n < words.length; n++) {
        const testLine = line + words[n] + " ";
        if (ctx.measureText(testLine).width > maxWidth && n > 0) {
          ctx.fillText(line, x, y);
          line = words[n] + " ";
          y += lineHeight;
        } else {
          line = testLine;
        }
      }
      ctx.fillText(line, x, y);
    }

    // âœ… Download fix (mobile-friendly)
    document.getElementById("downloadJpg").addEventListener("click", () => {
      cardCanvas.toBlob((blob) => {
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `kartu-wisuda-${(nameInput.value.trim() || "Ataa")}.jpg`;
        if (typeof a.download === "undefined") {
          // fallback: buka di tab baru (Safari/iPhone)
          window.open(url, "_blank");
        } else {
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
        }
        URL.revokeObjectURL(url);
      }, "image/jpeg", 0.95);
    });

    drawCard("Ataa");
  </script>
</body>
</html>
